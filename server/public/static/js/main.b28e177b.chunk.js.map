{"version":3,"sources":["contexts/ui-context.tsx","charts/definitions.js","services/service.js","components/audit/Audit.js","components/configuration/Protections.tsx","components/configuration/Rules.tsx","components/configuration/Settings.tsx","components/upgrade/Upgrade.tsx","utils/owasp-mapping.ts","components/dashboard/Dashboard.js","components/real-time/RealTime.tsx","logo.svg","store/index.ts","store/real-time.ts","store/dashboard.ts","store/audit.ts","App.tsx","reportWebVitals.ts","index.tsx"],"names":["UIContext","React","createContext","title","setTitle","subTitle","setSubTitle","UIContextProvider","children","useState","value","Provider","blockedAllowedDefinition","options","legend","display","scales","xAxes","gridLines","yAxes","ticks","beginAtZero","stepSize","maintainAspectRatio","request","labels","aggregation","type","query","size","aggs","aggName","terms","field","count","value_count","topRulesDefinition","autoSkip","fontFamily","topStatusCodesDefinition","position","topSeverityDefinition","rulesPerMinuteDefinition","time","unit","distribution","date_histogram","fixed_interval","min_doc_count","cardinality","topClientsDefinition","auditLogDefinition","sort","fetchData","definition","action","timeRange","startTime","endTime","bool","must","range","time_stamp","gte","lte","requestOptions","method","headers","body","JSON","stringify","backend_host","process","REACT_APP_BACKEND_HOST","console","log","fetch","then","resp","json","RangePicker","DatePicker","connect","state","dataSource","audit","dispatch","setData","setTimeRange","props","uiContext","useContext","data","date","columns","dataIndex","render","_","doc","moment","_source","format","client_ip","client_port","filtered","ellipsis","showTitle","uri","placement","response","http_code","message","details","severity","useEffect","fetchRawData","values","Date","now","span","offset","showTime","onOk","length","rowKey","record","_id","expandable","expandedRowRender","style","margin","host_ip","file","rowExpandable","pagination","defaultPageSize","showSizeChanger","static_data","name","ip","port","protocol","enabled","Protections","key","e","defaultChecked","Rules","rule","group","Option","Select","Settings","labelCol","wrapperCol","Item","label","defaultValue","min","max","step","htmlType","Upgrade","marginBottom","href","rel","target","RULE_ID_MAPPINGS","category","description","tagText","mapRuleId","ruleId","prefix","Object","keys","find","p","startsWith","interval","charts","dashboard","realTimeRequests","realTime","auditDocuments","filter","ad","status","slice","autoRefresh","setBlockedAllowedData","setTopRules","setTopClients","setTopStatusCodes","setTopSeverity","setRulesPerMinute","setInterval","clearInterval","requestsTableColumns","ts","url","titles","tags","messages","map","m","r","Array","from","Set","tag","color","rulesPerMinute","datasets","height","width","justifyContent","alignItems","image","Empty","PRESENTED_IMAGE_SIMPLE","blockedAllowed","topRules","topClients","topStatusCodes","topSeverity","extra","to","requests","models","createModel","reducers","addAuditDocument","payload","auditDocs","existingDocIdx","findIndex","a","unique_id","newDoc","cloneDeep","push","splice","topHosts","setTopHosts","valueOf","hits","store","init","Content","Layout","Sider","App","socket","io","on","close","minHeight","className","src","logo","alt","defaultSelectedKeys","defaultOpenKeys","mode","icon","DashboardOutlined","FieldTimeOutlined","FundViewOutlined","SubMenu","SettingOutlined","FileProtectOutlined","BarsOutlined","ControlOutlined","DollarCircleOutlined","Consumer","backIcon","path","component","RealTime","Audit","Dashboard","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b28e177b.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nexport type TUIContext = {\r\n  title: string,\r\n  setTitle: Function,\r\n  subTitle: string,\r\n  setSubTitle: Function\r\n};\r\n\r\n// we initialise them without default values, to make that happen, we\r\n// apply the Partial helper type.\r\nexport const UIContext = React.createContext<TUIContext>({\r\n  title: '',\r\n  setTitle: () => {},\r\n  subTitle: '',\r\n  setSubTitle: () => {},\r\n});\r\n\r\ninterface Props {\r\n  children: React.ReactNode\r\n}\r\n\r\nexport const UIContextProvider = ({ children }: Props) => {\r\n  const [title, setTitle] = React.useState<string>('');\r\n  const [subTitle, setSubTitle] = React.useState<string>('');\r\n\r\n  const value = {\r\n    title,\r\n    setTitle,\r\n    subTitle,\r\n    setSubTitle,\r\n  };\r\n\r\n  return (\r\n    <UIContext.Provider value={value}>\r\n      {children}\r\n    </UIContext.Provider>\r\n  );\r\n};\r\n","export const blockedAllowedDefinition = {\r\n    options: {\r\n        legend: {\r\n            display: false,\r\n        },\r\n        scales: {\r\n            xAxes: [{\r\n                gridLines: {\r\n                    display: false\r\n                }\r\n            }],\r\n            yAxes: [{\r\n                gridLines: {\r\n                    display: false\r\n                },\r\n                ticks: {\r\n                    beginAtZero: true,\r\n                    stepSize: 1,\r\n                }\r\n            }]\r\n        },\r\n        maintainAspectRatio: false\r\n    },\r\n    request: {\r\n        labels: [\"Allowed\", \"Blocked\"],\r\n        aggregation: true,\r\n        type: \"horizontal-bar\",\r\n        query : {\r\n            size: 0,\r\n            aggs: {\r\n                aggName: {\r\n                    terms: {\r\n                        field: \"status.keyword\"\r\n                    },\r\n                    aggs: {\r\n                        count: {\r\n                            value_count: {\r\n                                field: \"status.keyword\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n};\r\n\r\nexport const topRulesDefinition = {\r\n    options: {\r\n        legend: {\r\n            display: false,\r\n        },\r\n        scales: {\r\n            xAxes: [{\r\n                gridLines: {\r\n                    display: false,\r\n                },\r\n                ticks: {\r\n                    beginAtZero: true,\r\n                    stepSize: 1,\r\n                }\r\n            }],\r\n            yAxes: [{\r\n                ticks: {\r\n                    autoSkip: false,\r\n                    fontFamily: 'Roboto, Areal, sans-serif',\r\n                },\r\n                gridLines: {\r\n                    display: false\r\n                }\r\n            }]\r\n        },\r\n        maintainAspectRatio: false\r\n    },\r\n    request: {\r\n        aggregation: true,\r\n        type: \"horizontal-bar\",\r\n        query : {\r\n            size: 0,\r\n            aggs: {\r\n                aggName: {\r\n                    terms: {\r\n                        field: \"message.details.ruleId.keyword\"\r\n                    },\r\n                    aggs: {\r\n                        count: {\r\n                            value_count: {\r\n                                field: \"message.details.ruleId.keyword\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport const topHostsDefinition = {\r\n    options: {\r\n        legend: {\r\n            position: \"left\",\r\n        },\r\n        scales: {\r\n            xAxes: [{\r\n                display: false,\r\n                gridLines: {\r\n                    display: false\r\n                }\r\n            }],\r\n            yAxes: [{\r\n                display: false,\r\n                gridLines: {\r\n                    display: false\r\n                }\r\n            }]\r\n        },\r\n        maintainAspectRatio: false\r\n    },\r\n    request: {\r\n        aggregation: true,\r\n        type: \"doughnut\",\r\n        query : {\r\n            size: 0,\r\n            aggs: {\r\n                aggName: {\r\n                    terms: {\r\n                        field: \"host_ip.keyword\"\r\n                    },\r\n                    aggs: {\r\n                        count: {\r\n                            value_count: {\r\n                                field: \"host_ip.keyword\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport const topStatusCodesDefinition = {\r\n    options: {\r\n        legend: {\r\n            position: \"left\",\r\n        },\r\n        scales: {\r\n            xAxes: [{\r\n                display: false,\r\n                gridLines: {\r\n                    display: false\r\n                }\r\n            }],\r\n            yAxes: [{\r\n                display: false,\r\n                gridLines: {\r\n                    display: false\r\n                }\r\n            }]\r\n        },\r\n        maintainAspectRatio: false\r\n    },\r\n    request: {\r\n        aggregation: true,\r\n        type: \"doughnut\",\r\n        query : {\r\n            size: 0,\r\n            aggs: {\r\n                aggName: {\r\n                    terms: {\r\n                        field: \"response.http_code\"\r\n                    },\r\n                    aggs: {\r\n                        count: {\r\n                            value_count: {\r\n                                field: \"response.http_code\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport const topSeverityDefinition = {\r\n    options: {\r\n        legend: {\r\n            display: false,\r\n        },\r\n        scales: {\r\n            xAxes: [{\r\n                gridLines: {\r\n                    display: false\r\n                },\r\n                ticks: {\r\n                    stepSize: 1,\r\n                    beginAtZero: true,\r\n                }\r\n            }],\r\n            yAxes: [{\r\n                gridLines: {\r\n                    display: false\r\n                }\r\n            }]\r\n        },\r\n        maintainAspectRatio: false\r\n    },\r\n    request: {\r\n        aggregation: true,\r\n        type: \"horizontal-bar\",\r\n        query : {\r\n            size: 0,\r\n            aggs: {\r\n                aggName: {\r\n                    terms: {\r\n                        field: \"message.details.severity.keyword\"\r\n                    },\r\n                    aggs: {\r\n                        count: {\r\n                            value_count: {\r\n                                field: \"message.details.severity.keyword\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport const rulesPerMinuteDefinition = {\r\n    options: {\r\n        maintainAspectRatio: false,\r\n        legend: {\r\n            display: false\r\n        },\r\n        scales: {\r\n            xAxes: [{\r\n                gridLines: {\r\n                    display: false\r\n                },\r\n                type: 'time',\r\n                time: {\r\n                    unit: 'minute'\r\n                },\r\n                distribution: 'series'\r\n            }],\r\n            yAxes: [{\r\n                gridLines: {\r\n                    display: false\r\n                },\r\n                ticks: {\r\n                    stepSize: 1,\r\n                    beginAtZero: true\r\n                }\r\n            }]\r\n        }\r\n    },\r\n    request: {\r\n        aggregation: true,\r\n        type: \"time\",\r\n        query : {\r\n            size: 0,\r\n            aggs: {\r\n                aggName: {\r\n                    date_histogram: {\r\n                        field: \"time_stamp\",\r\n                        fixed_interval: \"5m\",\r\n                        min_doc_count : 1,\r\n                    },\r\n                    aggs: {\r\n                        count: {\r\n                            cardinality: {\r\n                                field: \"unique_id.keyword\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport const topClientsDefinition = {\r\n    options: {\r\n        legend: {\r\n            position: \"left\",\r\n        },\r\n        scales: {\r\n            xAxes: [{\r\n                display: false,\r\n                gridLines: {\r\n                    display: false\r\n                }\r\n            }],\r\n            yAxes: [{\r\n                display: false,\r\n                gridLines: {\r\n                    display: false\r\n                }\r\n            }]\r\n        },\r\n        maintainAspectRatio: false\r\n    },\r\n    request: {\r\n        aggregation: true,\r\n        type: \"horizontal-bar\",\r\n        query : {\r\n            size: 0,\r\n            aggs: {\r\n                aggName: {\r\n                    terms: {\r\n                        field: \"client_ip.keyword\"\r\n                    },\r\n                    aggs: {\r\n                        count: {\r\n                            value_count: {\r\n                                field: \"client_ip.keyword\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\nexport const auditLogDefinition = {\r\n    request: {\r\n        aggregation: false,\r\n        query : {\r\n            \"size\": 5000,\r\n            sort: {\r\n                \"time_stamp\" : {\"order\" : \"desc\"}\r\n            }\r\n        }\r\n    }\r\n\r\n}","export const fetchData = (definition, action, timeRange) => {\r\n    if(timeRange.startTime && timeRange.endTime){\r\n        definition.request.query.query = {\r\n            bool: {\r\n                must: [\r\n                    {\r\n                        range: {\r\n                            time_stamp: {\r\n                                gte: timeRange.startTime,\r\n                                lte: timeRange.endTime\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        }\r\n    }\r\n    else if(timeRange.startTime) {\r\n        definition.request.query.query = {\r\n            bool: {\r\n                must: [\r\n                    {\r\n                        range: {\r\n                            time_stamp: {\r\n                                gte: timeRange.startTime\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        }\r\n\r\n    }\r\n    const requestOptions = {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(definition.request),\r\n    };\r\n\r\n    const backend_host = process.env.REACT_APP_BACKEND_HOST || 'localhost';\r\n    console.log(requestOptions);\r\n    fetch(`http://${backend_host}:8088/history`, requestOptions)\r\n        .then((resp) => resp.json().then((body) => {\r\n            console.log(body);\r\n            action(body);\r\n        }));\r\n};\r\n\r\n\r\nexport const fetchRawData = (definition, action, timeRange) => {\r\n    if(timeRange.startTime && timeRange.endTime){\r\n        definition.request.query.query = {\r\n            bool: {\r\n                must: [\r\n                    {\r\n                        range: {\r\n                            time_stamp: {\r\n                                gte: timeRange.startTime,\r\n                                lte: timeRange.endTime\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        }\r\n    }\r\n    else if(timeRange.startTime) {\r\n        definition.request.query.query = {\r\n            bool: {\r\n                must: [\r\n                    {\r\n                        range: {\r\n                            time_stamp: {\r\n                                gte: timeRange.startTime\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        }\r\n\r\n    }\r\n    const requestOptions = {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(definition.request),\r\n    };\r\n\r\n    const backend_host = process.env.REACT_APP_BACKEND_HOST || 'localhost';\r\n    console.log(requestOptions);\r\n    fetch(`http://${backend_host}:8088/history`, requestOptions)\r\n        .then((resp) => resp.json().then((body) => {\r\n            console.log(body);\r\n            action(body);\r\n        }));\r\n};\r\n","import { TUIContext, UIContext } from 'contexts/ui-context';\r\nimport React, { useContext, useEffect, useState } from 'react';\r\nimport {Col, DatePicker, Row, Table, Tag, Tooltip, Card} from \"antd\";\r\nimport {auditLogDefinition} from \"../../charts/definitions\";\r\nimport {fetchRawData} from \"../../services/service\";\r\nimport moment from \"moment\";\r\nimport {connect} from \"react-redux\";\r\n\r\nconst { RangePicker } = DatePicker;\r\nconst mapState = (state) => ({\r\n    dataSource: state.audit.dataSource,\r\n    timeRange: state.audit.timeRange,\r\n});\r\n\r\nconst mapDispatch = (dispatch) => ({\r\n    setData : dispatch.audit.setData,\r\n    setTimeRange : dispatch.audit.setTimeRange,\r\n});\r\n\r\nconst Audit = (props) => {\r\n  const uiContext = useContext(UIContext);\r\n  const {data} = useState({date: []});\r\n\r\n  const columns = [\r\n    {\r\n        title: 'Date & Time',\r\n        dataIndex: 'time_stamp',\r\n        render: (_, doc) => moment(doc._source.time_stamp).format('ll LTS'),\r\n    },\r\n    {\r\n        title: 'Source',\r\n        dataIndex: 'client_ip',\r\n        render: (_, doc) => `${doc._source.client_ip}:${doc._source.client_port}`,\r\n        filtered: true,\r\n    },\r\n    {\r\n        title: 'URL',\r\n        dataIndex: ['request', 'uri'],\r\n        ellipsis: {\r\n            showTitle: false,\r\n        },\r\n        render: (_, doc) => <Tooltip title={doc._source.request.uri} placement=\"topLeft\">{doc._source.request.uri}</Tooltip>\r\n    },\r\n    {\r\n        title: 'Status Code',\r\n        dataIndex: ['response', 'http_code'],\r\n        render: (_, doc) => doc._source.response.http_code,\r\n        filtered: true,\r\n    },\r\n    {\r\n        title: 'Severity',\r\n        dataIndex: ['message', 'message', 'details', 'severity'],\r\n        render: (_, doc) => doc._source.message ? doc._source.message.details.severity : 'None',\r\n    },\r\n    {\r\n        title: 'Rule ID',\r\n        dataIndex: ['message', 'message', 'details', 'ruleId'],\r\n        //render: (_, doc) => doc._source.message? doc._source.message.details.ruleId : 'None',\r\n    },\r\n  ];\r\n\r\n    function onOk(value) {\r\n        if(value.length === 2){\r\n            if(value[0] !== null && value[1] !== null){\r\n                props.setTimeRange(value);\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n  useEffect(() => {\r\n    uiContext.setTitle('Audit');\r\n    uiContext.setSubTitle('Inspect your web application security in depth');\r\n    console.log(props.timeRange);\r\n    fetchRawData(auditLogDefinition, props.setData, props.timeRange);\r\n  }, [data, props.timeRange]);\r\n\r\n  useEffect( () => () => {\r\n      let start = moment(Date.now() - 900000);\r\n      let end = null;\r\n      let values = [start, end];\r\n      props.setTimeRange(values);\r\n  },\r\n [] );\r\n\r\n  return (\r\n    <div>\r\n      <Row>\r\n        <Col span={6} offset={18}>\r\n            <RangePicker\r\n                showTime={{ format: 'HH:mm' }}\r\n                format=\"YYYY-MM-DD HH:mm\"\r\n                onOk={onOk}\r\n            />\r\n        </Col>\r\n      </Row>\r\n      <Table dataSource={props.dataSource.data ? props.dataSource.data : []} columns={columns} rowKey={record => record._id}\r\n             expandable={{\r\n                 expandedRowRender: record =>\r\n                     <Card><p style={{ margin: 50 }}>\r\n                         Host IP: {record._source.host_ip}<br/>\r\n                         Message: {record._source.message.message}<br/>\r\n                         Rule Data: {record._source.message.details.data}<br/>\r\n                         Rule Conf File: {record._source.message.details.file}<br/>\r\n                     </p></Card>\r\n                ,\r\n                 rowExpandable: record => record._source.message\r\n             }}\r\n             pagination={{defaultPageSize: 25, showSizeChanger: true}} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default connect(mapState, mapDispatch)(Audit);\r\n","import { TUIContext, UIContext } from 'contexts/ui-context';\r\nimport React, { useContext, useEffect } from 'react';\r\nimport {ColumnsType} from \"antd/es/table\";\r\nimport {ProtectedEntityDocument} from \"../../store/types/protected-entity-document\";\r\nimport {Switch, Table} from \"antd\";\r\n// import {Card, Col, Row, Table, Tag, Tooltip} from \"antd\";\r\n// import {mapRuleId} from \"../../utils/owasp-mapping\";\r\n// import {fetchRawData} from \"../../services/service\";\r\n// import {auditLogDefinition} from \"../../charts/definitions\";\r\n\r\nconst static_data = [\r\n  {\r\n    name: 'radware.buzz',\r\n    ip: '11.61.16.6',\r\n    port: 443,\r\n    protocol: 'HTTPS',\r\n    enabled: true,\r\n  },\r\n  {\r\n    name: 'github.army',\r\n    ip: '116.611.161.6',\r\n    port: 443,\r\n    protocol: 'HTTPS',\r\n    enabled: true,\r\n  },\r\n  {\r\n    name: 'hiho.io',\r\n    ip: '77.77.1.1',\r\n    port: 80,\r\n    protocol: 'HTTP',\r\n    enabled: true,\r\n  },\r\n];\r\n\r\nconst Protections: React.FunctionComponent = () => {\r\n  const uiContext = useContext<TUIContext>(UIContext);\r\n\r\n  useEffect(() => {\r\n    uiContext.setTitle('Web Applications');\r\n    uiContext.setSubTitle('Protect your web applications');\r\n  });\r\n\r\n  const columns: ColumnsType<ProtectedEntityDocument> = [\r\n    {\r\n      title: 'Name',\r\n      dataIndex: 'name',\r\n      key: 'name',\r\n    },\r\n    {\r\n      title: 'IP',\r\n      dataIndex: 'ip',\r\n      key: 'ip',\r\n    },\r\n    {\r\n      title: 'Port',\r\n      dataIndex: 'port',\r\n      key: 'port',\r\n    },\r\n    {\r\n      title: 'Protocol',\r\n      dataIndex: 'protocol',\r\n      key: 'protocol',\r\n    },\r\n    {\r\n      title: 'Enabled',\r\n      dataIndex: 'enabled',\r\n      render: (e: any, record: any) => (< Switch defaultChecked={e} />)\r\n    },\r\n\r\n  ];\r\n\r\n\r\n  return (\r\n      <div>\r\n        <Table dataSource={static_data} columns={columns} rowKey='name'/>\r\n      </div>\r\n  );\r\n\r\n};\r\n\r\nexport default Protections;\r\n","import { TUIContext, UIContext } from 'contexts/ui-context';\r\nimport React, { useContext, useEffect } from 'react';\r\nimport {Button, Col, Row, Space, Switch, Table} from 'antd';\r\n\r\nconst Rules: React.FunctionComponent = () => {\r\n  const uiContext = useContext<TUIContext>(UIContext);\r\n\r\n  const columns = [\r\n    {\r\n      title: 'Rule',\r\n      dataIndex: 'rule',\r\n    },\r\n    {\r\n      title: 'Type',\r\n      dataIndex: 'type',\r\n    },\r\n    {\r\n      title: 'Rule Group',\r\n      dataIndex: 'group',\r\n    },\r\n    {\r\n      title: 'Rule Group',\r\n      dataIndex: 'group',\r\n    },\r\n    {\r\n      title: 'Enabled',\r\n      dataIndex: 'enabled',\r\n      render: (e: any, record: any) => (< Switch defaultChecked={e} />)\r\n    },\r\n  ];\r\n\r\n\r\n  const data = [\r\n    {\r\n      rule: 'INITIALIZATION',\r\n      group: '901',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'DRUPAL-EXCLUSION-RULES',\r\n      group: '903.9001',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'WORDPRESS-EXCLUSION-RULES',\r\n      group: '903.9002',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'NEXTCLOUD-EXCLUSION-RULES',\r\n      group: '903.9003',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'DOKUWIKI-EXCLUSION-RULES',\r\n      group: '903.9004',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'CPANEL-EXCLUSION-RULES',\r\n      group: '903.9005',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'COMMON-EXCEPTIONS',\r\n      group: '905',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'IP-REPUTATION',\r\n      group: '910',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'METHOD-ENFORCEMENT',\r\n      group: '911',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'DOS-PROTECTIONT',\r\n      group: '912',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'SCANNER-DETECTION',\r\n      group: '913',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'PROTOCOL-ENFORCEMENT',\r\n      group: '920',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'PROTOCOL-ENFORCEMENT',\r\n      group: '920',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'PROTOCOL-ENFORCEMENT',\r\n      group: '920',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'PROTOCOL-ENFORCEMENT',\r\n      group: '920',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'PROTOCOL-ATTACK',\r\n      group: '921',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'APPLICATION-ATTACK-LFIT',\r\n      group: '930',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'APPLICATION-ATTACK-RFI',\r\n      group: '931',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'APPLICATION-ATTACK-RCE',\r\n      group: '932',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'APPLICATION-ATTACK-PHP',\r\n      group: '933',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'APPLICATION-ATTACK-XSS',\r\n      group: '941',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'APPLICATION-ATTACK-SQLI',\r\n      group: '942',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'APPLICATION-ATTACK-SESSION-FIXATION',\r\n      group: '943',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'APPLICATION-ATTACK-JAVA',\r\n      group: '944',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'BLOCKING-EVALUATION',\r\n      group: '949',\r\n      type: 'Request',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'DATA-LEAKAGES',\r\n      group: '950',\r\n      type: 'Response',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'DATA-LEAKAGES-SQL',\r\n      group: '951',\r\n      type: 'Response',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'DATA-LEAKAGES-JAVA',\r\n      group: '952',\r\n      type: 'Response',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'DATA-LEAKAGES-PHP',\r\n      group: '953',\r\n      type: 'Response',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'DATA-LEAKAGES-IIS',\r\n      group: '954',\r\n      type: 'Response',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'LOCKING-EVALUATION',\r\n      group: '959',\r\n      type: 'Response',\r\n      enabled: true\r\n    },\r\n    {\r\n      rule: 'CORRELATION',\r\n      group: '980',\r\n      type: 'Response',\r\n      enabled: true\r\n    },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    uiContext.setTitle('Rules');\r\n    uiContext.setSubTitle('Fine tune your firewall rules');\r\n  });\r\n\r\n  return (\r\n      <div>\r\n        <div>List of OWASP Top 10 rules to enable/disable</div>\r\n        <Row>\r\n          <Col span={6} offset={18}>\r\n            <Space>\r\n              <Button type=\"primary\">Add New Rule</Button>\r\n              <Button type=\"primary\">Purchase Radware Rule Set</Button>\r\n            </Space>\r\n          </Col>\r\n        </Row>\r\n\r\n        <Table columns={columns} dataSource={data} pagination={{defaultPageSize: 10, showSizeChanger: true}}/>\r\n      </div>\r\n\r\n\r\n  );\r\n}\r\n\r\nexport default Rules;\r\n","import { TUIContext, UIContext } from 'contexts/ui-context';\r\nimport { Form, Select, InputNumber, Switch, Button } from 'antd';\r\nimport React, { useContext, useEffect } from 'react';\r\nconst { Option } = Select;\r\n\r\nconst Settings: React.FunctionComponent = () => {\r\n  const uiContext = useContext<TUIContext>(UIContext);\r\n\r\n  useEffect(() => {\r\n    uiContext.setTitle('Settings');\r\n    uiContext.setSubTitle('Configure the WAF Proxy');\r\n  });\r\n\r\n  const layout = {\r\n    labelCol: { span: 4 },\r\n    wrapperCol: { span: 8 },\r\n  };\r\n  const tailLayout = {\r\n    wrapperCol: { offset: 4, span: 8 },\r\n  };\r\n\r\n  return (\r\n    <Form {...layout} >\r\n      <Form.Item label=\"Number of Threads\" >\r\n        <Select defaultValue=\"auto\">\r\n          <Option value=\"auto\">Auto</Option>\r\n          <Option value=\"1\">1</Option>\r\n          <Option value=\"2\">2</Option>\r\n          <Option value=\"4\">4</Option>\r\n          <Option value=\"8\">8</Option>\r\n        </Select>\r\n      </Form.Item>\r\n      <Form.Item label=\"Connections Per Thread\">\r\n        <InputNumber min={1024} max={8192} step={1024} defaultValue={4096} />\r\n      </Form.Item>\r\n      <Form.Item label=\"Log level\">\r\n        <Select defaultValue=\"warn\">\r\n          <Option value=\"warn\">Warning</Option>\r\n          <Option value=\"error\">Error</Option>\r\n          <Option value=\"crit\">Critical</Option>\r\n          <Option value=\"alert\">Alert</Option>\r\n          <Option value=\"emerg\">Emergency</Option>\r\n        </Select>\r\n      </Form.Item>\r\n      <Form.Item label=\"Check Response Bodies\">\r\n        <Switch defaultChecked />\r\n      </Form.Item>\r\n      <Form.Item {...tailLayout}>\r\n        <Button type=\"primary\" htmlType=\"submit\">\r\n          Submit\r\n        </Button>\r\n      </Form.Item>\r\n    </Form>\r\n  );\r\n}\r\n\r\nexport default Settings;\r\n","import { TUIContext, UIContext } from 'contexts/ui-context';\r\nimport React, { useContext, useEffect } from 'react';\r\n\r\nconst Upgrade: React.FunctionComponent = () => {\r\n    const uiContext = useContext<TUIContext>(UIContext);\r\n\r\n    useEffect(() => {\r\n        uiContext.setTitle('Upgrade');\r\n        uiContext.setSubTitle(\"Upgrade your firewall to Radware's professional WAF\");\r\n    });\r\n\r\n    return (\r\n        <div>\r\n        <div style={{marginBottom: '30px'}}><a href='https://www.radware.com' rel='noreferrer' target='_blank'>Upgrade to Radware Premium Ruleset</a></div>\r\n        <div><a href='https://www.radware.com/products/cloud-waf-service/' rel='noreferrer' target='_blank'>Upgrade to Professional Radware Products</a></div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Upgrade;\r\n","export interface RuleInfo {\r\n  display: boolean,\r\n  category: string,\r\n  title: string,\r\n  description: string,\r\n  tagText?: string,\r\n  tagBgColor?: string,\r\n}\r\n\r\nexport const RULE_ID_MAPPINGS: { [key: string]: RuleInfo } = {\r\n  '10': {\r\n    display: false,\r\n    category: 'REQUEST-10-GEO-IP-DATA',\r\n    title: 'Geo IP Data',\r\n    description: 'Geo IP Data',\r\n    tagText: 'GEO-IP-DATA',\r\n  },\r\n  '901': {\r\n    display: false,\r\n    category: 'REQUEST-901-INITIALIZATION',\r\n    title: 'CRS Initialization',\r\n    description: 'Initializes the Core Rules and performs preparatory actions. It also fixes errors and omissions of variable definitions in the setup file.',\r\n  },\r\n  '905': {\r\n    display: false,\r\n    category: 'REQUEST-905-COMMON-EXCEPTIONS',\r\n    title: 'Common exceptions',\r\n    description: 'Used as an exception mechanism to remove common false positives that may be encountered.',\r\n  },\r\n  '910': {\r\n    display: true,\r\n    category: 'REQUEST-910-IP-REPUTATION',\r\n    title: 'IP Reputation and Geo IP',\r\n    description: 'Uses data from previous requests, ProjectHoneypot\\'s block list and Geo IP data to determine the level of risk presented by the user.',\r\n    tagText: 'IP-REPUTATION',\r\n  },\r\n  '911': {\r\n    display: true,\r\n    category: 'REQUEST-911-METHOD-ENFORCEMENT',\r\n    title: 'HTTP Methods',\r\n    description: 'Blocks requests with forbidden HTTP methods PUT and PATCH.',\r\n    tagText: 'HTTP-METHOD',\r\n  },\r\n  '912': {\r\n    display: true,\r\n    category: 'REQUEST-912-DOS-PROTECTION',\r\n    title: 'Denial of Service',\r\n    description: 'Anti-Automation rules to detect Denial of Service attacks.',\r\n    tagText: 'DoS',\r\n  },\r\n  '913': {\r\n    display: true,\r\n    category: 'REQUEST-913-SCANNER-DETECTION',\r\n    title: 'Port and environment scanners',\r\n    description: 'Protection against port and environment scanners like security scanners, scripted HTTP clients, web crawlers and bots.',\r\n    tagText: 'SCANNER',\r\n  },\r\n  '920': {\r\n    display: true,\r\n    category: 'REQUEST-920-PROTOCOL-ENFORCEMENT',\r\n    title: 'HTTP Protocol Violation',\r\n    description: 'Protection against common HTTP protocol violations used in application layer attacks by validating HTTP requests against HTTP RFC.',\r\n    tagText: 'PROTOCOL-INVALID',\r\n  },\r\n  '921': {\r\n    display: true,\r\n    category: 'REQUEST-921-PROTOCOL-ATTACK',\r\n    title: 'HTTP Protocol Attack',\r\n    description: 'Protection against header injection, request smuggling, response splitting and parameter pollution.',\r\n    tagText: 'PROTOCOL-ATTACK',\r\n  },\r\n  '930': {\r\n    display: true,\r\n    category: 'REQUEST-930-APPLICATION-ATTACK-LFI',\r\n    title: 'Local File Inclusion',\r\n    description: 'Protection against directory and path traversal attacks, OS file access and restricted file access.',\r\n    tagText: 'FILE-PATH',\r\n  },\r\n  '931': {\r\n    display: true,\r\n    category: 'REQUEST-931-APPLICATION-ATTACK-RFI',\r\n    title: 'Remote File Inclusion',\r\n    description: 'Protection against common types of remote file inclusion (RFI) attack methods like URL parameter using IP address, common RFI vulnerable parameter name used in URL payload, data ends with question mark(s), off-domain reference/kink.',\r\n    tagText: 'REMOTE-FILE',\r\n  },\r\n  '932': {\r\n    display: true,\r\n    category: 'REQUEST-932-APPLICATION-ATTACK-RCE',\r\n    title: 'Remote Command Execution',\r\n    description: 'Protection against remote code execution attacks for Unix and Windows with Shell and PowerShell commands injection, and protection against Shellshock (CVE-2014-6271).',\r\n    tagText: 'REMOTE-COMMAND',\r\n  },\r\n  '933': {\r\n    display: true,\r\n    category: 'REQUEST-933-APPLICATION-ATTACK-PHP',\r\n    title: 'PHP Injection',\r\n    description: 'Protection against PHP injection attacks like opening/closing tag, script file upload, configuration directive, variables, I/O stream and function name and call.',\r\n    tagText: 'PHP',\r\n  },\r\n  '934': {\r\n    display: true,\r\n    category: 'REQUEST-934-APPLICATION-ATTACK-NODEJS',\r\n    title: 'NodeJs Injection',\r\n    description: 'Protection against NodeJs injection attacks like insecure unserialization and generic RCE signatures.',\r\n    tagText: 'NODEJS',\r\n  },\r\n  '941': {\r\n    display: true,\r\n    category: 'REQUEST-941-APPLICATION-ATTACK-XSS',\r\n    title: 'Cross-Site Scripting',\r\n    description: 'Protection against a wide range of cross-site scripting attacks.',\r\n    tagText: 'XSS',\r\n  },\r\n  '942': {\r\n    display: true,\r\n    category: 'REQUEST-942-APPLICATION-ATTACK-SQLI',\r\n    title: 'SQL Injection',\r\n    description: 'Protection against a wide range of SQL injection attacks.',\r\n    tagText: 'SQL',\r\n  },\r\n  '943': {\r\n    display: true,\r\n    category: 'REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION',\r\n    title: 'Session Fixation',\r\n    description: 'Protection against session fixation attacks through cookies and parameters.',\r\n    tagText: 'SESSION',\r\n  },\r\n  '944': {\r\n    display: true,\r\n    category: 'REQUEST-944-APPLICATION-ATTACK-JAVA',\r\n    title: 'Java Attack',\r\n    description: 'Protection against common Java attacks like payload execution, remote command execution, common Java classes, functions and keywords and known vulnerabilities in Apache Struts and Java deserialization.',\r\n    tagText: 'JAVA',\r\n  },\r\n  '949': {\r\n    display: false,\r\n    category: 'REQUEST-949-BLOCKING-EVALUATION',\r\n    title: 'Request Blocking Evaluation',\r\n    description: 'Evaluating the action to take on the request based on the calculated anomaly score and IP reputation checks.',\r\n  },\r\n  '950': {\r\n    display: true,\r\n    category: 'RESPONSE-950-DATA-LEAKAGES',\r\n    title: 'Data Leakage',\r\n    description: 'Protection against data leakages in the response like directory listing, CGI source code and application status information.',\r\n    tagText: 'DATA-LEAK',\r\n  },\r\n  '951': {\r\n    display: true,\r\n    category: 'RESPONSE-951-DATA-LEAKAGES-SQL',\r\n    title: 'SQL Leakage',\r\n    description: 'Protection against SQL error message leakages for multiple SQL databases (MySQL, PostgreSQL, MS Access, Oracle, sqlite, and many More).',\r\n    tagText: 'SQL-LEAK',\r\n  },\r\n  '952': {\r\n    display: true,\r\n    category: 'RESPONSE-952-DATA-LEAKAGES-JAVA',\r\n    title: 'Java Leakage',\r\n    description: 'Protection against Java source code and error message leakages.',\r\n    tagText: 'JAVA-LEAK',\r\n  },\r\n  '953': {\r\n    display: true,\r\n    category: 'RESPONSE-953-DATA-LEAKAGES-PHP',\r\n    title: 'PHP Leakage',\r\n    description: 'Protection against PHP source code and error message leakages.',\r\n    tagText: 'PHP-LEAK',\r\n  },\r\n  '954': {\r\n    display: true,\r\n    category: 'RESPONSE-954-DATA-LEAKAGES-IIS',\r\n    title: 'IIS Leakage',\r\n    description: 'Protection against sensitive information leakages for Microsoft IIS server, like server default location and error messages.',\r\n    tagText: 'IIS-LEAK',\r\n  },\r\n  '959': {\r\n    display: false,\r\n    category: 'RESPONSE-959-BLOCKING-EVALUATION',\r\n    title: 'Response Blocking Evaluation',\r\n    description: 'Evaluating the action to take on the response based on the calculated anomaly score.',\r\n  },\r\n  '980': {\r\n    display: false,\r\n    category: 'RESPONSE-980-CORRELATION',\r\n    title: 'Response Post Processing',\r\n    description: 'Post processing after the response has been sent to the client (in the logging phase). Its purpose is to provide inbound + outbound correlation of events to provide a more intelligent designation as to the outcome or result of the transaction.',\r\n  },\r\n};\r\n\r\nexport function mapRuleId(ruleId: string): RuleInfo {\r\n  const rulesPrefix = Object.keys(RULE_ID_MAPPINGS);\r\n  const prefix = rulesPrefix.find(p => ruleId.startsWith(p));\r\n\r\n  if (prefix) {\r\n    return RULE_ID_MAPPINGS[prefix];\r\n  }\r\n\r\n  return {\r\n    display: false,\r\n    category: 'UNKNOWN',\r\n    title: 'Unknown',\r\n    description: 'Unknown rule.',\r\n  };\r\n}\r\n","import { Card, Col, DatePicker, Row, Table, Tag, Tooltip, Empty} from 'antd';\r\nimport { blockedAllowedDefinition, rulesPerMinuteDefinition, topClientsDefinition, topRulesDefinition, topSeverityDefinition, topStatusCodesDefinition } from 'charts/definitions';\r\nimport { UIContext } from 'contexts/ui-context';\r\nimport moment from 'moment';\r\nimport React, { useContext, useEffect, useState } from 'react';\r\nimport { Bar, Doughnut, HorizontalBar, Line } from 'react-chartjs-2';\r\nimport { connect } from 'react-redux';\r\nimport { Link } from 'react-router-dom';\r\nimport { fetchData } from '../../services/service';\r\nimport { mapRuleId } from '../../utils/owasp-mapping';\r\n\r\nconst { RangePicker } = DatePicker;\r\n\r\nlet interval = 0;\r\nconst mapState = (state) => ({\r\n  charts: state.dashboard.charts,\r\n  timeRange: state.dashboard.timeRange,\r\n  realTimeRequests: state.realTime.auditDocuments.filter(ad => ad.status === 'Blocked').slice(0, 5),\r\n  autoRefresh: state.dashboard.autoRefresh\r\n});\r\n\r\nconst mapDispatch = dispatch => ({\r\n  setBlockedAllowedData: dispatch.dashboard.setBlockedAllowedData,\r\n  setTopRules: dispatch.dashboard.setTopRules,\r\n  setTopClients: dispatch.dashboard.setTopClients,\r\n  setTopStatusCodes: dispatch.dashboard.setTopStatusCodes,\r\n  setTopSeverity: dispatch.dashboard.setTopSeverity,\r\n  setRulesPerMinute: dispatch.dashboard.setRulesPerMinute,\r\n  setTimeRange: dispatch.dashboard.setTimeRange,\r\n});\r\n\r\nconst Dashboard = (props) => {\r\n  const uiContext = useContext(UIContext);\r\n  const { charts } = useState({});\r\n\r\n  useEffect(() => {\r\n    uiContext.setTitle('Dashboard');\r\n    uiContext.setSubTitle('General overview of your web application\\'s security');\r\n    fetchData(blockedAllowedDefinition, props.setBlockedAllowedData, props.timeRange);\r\n    fetchData(topRulesDefinition, props.setTopRules, props.timeRange);\r\n    fetchData(topClientsDefinition, props.setTopClients, props.timeRange);\r\n    fetchData(topStatusCodesDefinition, props.setTopStatusCodes, props.timeRange);\r\n    fetchData(topSeverityDefinition, props.setTopSeverity, props.timeRange);\r\n    fetchData(rulesPerMinuteDefinition, props.setRulesPerMinute, props.timeRange);\r\n  }, [charts, props.timeRange]);\r\n\r\n  useEffect( () => () => {\r\n    let start = moment(Date.now() - 900000);\r\n    let end = null;\r\n    let values = [start, end];\r\n    props.setTimeRange({value : values});\r\n  },[] );\r\n\r\n  useEffect(() => {\r\n    if (props.autoRefresh) {\r\n      console.log(props.autoRefresh);\r\n      interval = setInterval(() => {\r\n        let start = moment(Date.now() - 900000);\r\n        let end = null;\r\n        let values = [start, end];\r\n        props.setTimeRange({value : values});\r\n      }, 10000);\r\n      return () => clearInterval(interval);\r\n    }\r\n  }, [props.autoRefresh]);\r\n\r\n  function onOk(value) {\r\n    if (value.length === 2) {\r\n      if (value[0] !== null && value[1] !== null) {\r\n        clearInterval(interval);\r\n        props.setTimeRange({value : value, autoRefresh: false});\r\n      }\r\n    }\r\n  }\r\n\r\n  const requestsTableColumns = [\r\n    {\r\n      title: 'Time',\r\n      dataIndex: 'time_stamp',\r\n      render: ts => moment(ts).format('LTS'),\r\n    },\r\n    {\r\n      title: 'Source',\r\n      dataIndex: 'client_ip',\r\n      render: (client_ip, doc) => (doc.request.headers['55555'] ? doc.request.headers['55555'] : client_ip),\r\n    },\r\n    {\r\n      title: 'URL',\r\n      dataIndex: ['request', 'uri'],\r\n      ellipsis: {\r\n        showTitle: false,\r\n      },\r\n      render: url => (<Tooltip title={url} placement=\"topLeft\">{url}</Tooltip>),\r\n    },\r\n    {\r\n      title: 'Attacks',\r\n      dataIndex: ['messages'],\r\n      render: (_, doc) => {\r\n        const titles = {};\r\n        const tags = doc.messages\r\n          .map(m => mapRuleId(m.details.ruleId))\r\n          .filter(r => r.display && r.tagText)\r\n          .map((r) => {\r\n            titles[r.tagText] = r.title;\r\n            return r.tagText;\r\n          });\r\n        const uniqueTags = Array.from(new Set(tags));\r\n        return uniqueTags.map((tag) => {\r\n          return (\r\n            <Tooltip title={titles[tag]}>\r\n              <Tag color='red'>{tag}</Tag>\r\n            </Tooltip>\r\n          );\r\n        });\r\n      },\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div>\r\n      <Row>\r\n        <Col span={6} offset={18}>\r\n          <RangePicker\r\n            showTime={{ format: 'HH:mm' }}\r\n            format=\"YYYY-MM-DD HH:mm\"\r\n            onOk={onOk}\r\n          />\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col span={24}>\r\n          <Card title=\"Total Requests\">\r\n            {props.charts.rulesPerMinute.data && props.charts.rulesPerMinute.data.datasets && props.charts.rulesPerMinute.data.datasets.length > 0 ?\r\n            <Line\r\n              data={props.charts.rulesPerMinute.data}\r\n              height={300}\r\n              width={100}\r\n              options={rulesPerMinuteDefinition.options}\r\n            />\r\n                : <div style={{width: 'auto', height: 300, display: 'flex', justifyContent: 'center', alignItems: 'center', }}><Empty image={Empty.PRESENTED_IMAGE_SIMPLE} /></div> }\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col span={12}>\r\n          <Card title=\"Blocked and Allowed Requests\">\r\n            {props.charts.blockedAllowed.data && props.charts.blockedAllowed.data.datasets && props.charts.blockedAllowed.data.datasets.length > 0 ?\r\n            <Bar\r\n              data={props.charts.blockedAllowed.data}\r\n              height={300}\r\n              width={100}\r\n              options={blockedAllowedDefinition.options}\r\n            />\r\n                : <div style={{width: 'auto', height: 300, display: 'flex', justifyContent: 'center', alignItems: 'center', }}><Empty image={Empty.PRESENTED_IMAGE_SIMPLE} /></div> }\r\n          </Card>\r\n        </Col>\r\n        <Col span={12}>\r\n\r\n          <Card title=\"Top Rules\">\r\n            {props.charts.topRules.data && props.charts.topRules.data.datasets && props.charts.topRules.data.datasets.length > 0 ?\r\n            <HorizontalBar\r\n              data={{ datasets: props.charts.topRules.data.datasets, labels: props.charts.topRules.data.labels.map(m => m + '-' + mapRuleId(m).title) }}\r\n              height={300}\r\n              width={100}\r\n              options={topRulesDefinition.options}\r\n            />\r\n                : <div style={{width: 'auto', height: 300, display: 'flex', justifyContent: 'center', alignItems: 'center', }}><Empty image={Empty.PRESENTED_IMAGE_SIMPLE} /></div> }\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col span={12}>\r\n          <Card title=\"Top Clients\">\r\n            {props.charts.topClients.data && props.charts.topClients.data.datasets && props.charts.topClients.data.datasets.length > 0 ?\r\n            <Doughnut\r\n              data={props.charts.topClients.data}\r\n              height={300}\r\n              width={100}\r\n              options={topClientsDefinition.options}\r\n            />\r\n                : <div style={{width: 'auto', height: 300, display: 'flex', justifyContent: 'center', alignItems: 'center', }}><Empty image={Empty.PRESENTED_IMAGE_SIMPLE} /></div> }\r\n          </Card>\r\n        </Col>\r\n        <Col span={12}>\r\n          <Card title=\"Top Status Codes\">\r\n            {props.charts.topStatusCodes.data && props.charts.topStatusCodes.data.datasets && props.charts.topStatusCodes.data.datasets.length > 0 ?\r\n            <Doughnut\r\n              data={props.charts.topStatusCodes.data}\r\n              height={300}\r\n              width={100}\r\n              options={topStatusCodesDefinition.options}\r\n            />\r\n                : <div style={{width: 'auto', height: 300, display: 'flex', justifyContent: 'center', alignItems: 'center', }}><Empty image={Empty.PRESENTED_IMAGE_SIMPLE} /></div> }\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col span={12}>\r\n          <Card title=\"Top Severity\">\r\n            {props.charts.topSeverity.data && props.charts.topSeverity.data.datasets && props.charts.topSeverity.data.datasets.length > 0 ?\r\n            <HorizontalBar\r\n              data={props.charts.topSeverity.data}\r\n              height={300}\r\n              width={100}\r\n              options={topSeverityDefinition.options}\r\n            />\r\n                : <div style={{width: 'auto', height: 300, display: 'flex', justifyContent: 'center', alignItems: 'center', }}><Empty image={Empty.PRESENTED_IMAGE_SIMPLE} /></div> }\r\n          </Card>\r\n        </Col>\r\n        <Col span={12}>\r\n          <Card title=\"Real Time Attacks\" extra={<Link to={`/audit`}>See All</Link>} style={{ height: '100%' }}>\r\n            <Table dataSource={props.realTimeRequests} columns={requestsTableColumns} rowKey='unique_id' pagination={false} size=\"small\" />\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  );\r\n\r\n};\r\n\r\nexport default connect(\r\n  mapState,\r\n  mapDispatch,\r\n)(Dashboard);\r\n","import { Table, Tag, Tooltip } from 'antd';\r\nimport { ColumnsType } from 'antd/es/table';\r\nimport { TUIContext, UIContext } from 'contexts/ui-context';\r\nimport moment from 'moment';\r\nimport React, { useContext, useEffect } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { RootState } from 'store';\r\nimport { AuditDocument } from 'store/types/audit-document';\r\nimport { mapRuleId } from 'utils/owasp-mapping';\r\n\r\nconst mapState = (state: RootState) => ({\r\n  requests: state.realTime.auditDocuments.filter(ad => ad.status === 'Blocked').slice(0, 10),\r\n});\r\n\r\ntype Props = ReturnType<typeof mapState>;\r\n\r\nconst columns: ColumnsType<AuditDocument> = [\r\n  {\r\n    title: 'Date & Time',\r\n    dataIndex: 'time_stamp',\r\n    render: ts => moment(ts).format('ll LTS'),\r\n  },\r\n  {\r\n    title: 'Source',\r\n    dataIndex: 'client_ip',\r\n    render: (client_ip, doc) => (doc.request.headers['55555'] ? doc.request.headers['55555'] : client_ip),\r\n    filtered: true,\r\n  },\r\n  {\r\n    title: 'URL',\r\n    dataIndex: ['request', 'uri'],\r\n    ellipsis: {\r\n      showTitle: false,\r\n    },\r\n    render: url => (<Tooltip title={url} placement=\"topLeft\">{url}</Tooltip>),\r\n  },\r\n  {\r\n    title: 'Status Code',\r\n    dataIndex: ['response', 'http_code'],\r\n  },\r\n  {\r\n    title: 'Attacks',\r\n    dataIndex: ['messages'],\r\n    render: (_, doc) => {\r\n      const titles: { [key: string]: string } = {};\r\n      const tags = doc.messages\r\n        .map(m => mapRuleId(m.details.ruleId))\r\n        .filter(r => r.display && r.tagText)\r\n        .map((r) => {\r\n          titles[r.tagText!] = r.title;\r\n          return r.tagText!;\r\n        });\r\n      const uniqueTags = Array.from(new Set(tags));\r\n      return uniqueTags.map((tag) => {\r\n        return (\r\n          <Tooltip title={titles[tag]}>\r\n            <Tag color='red'>{tag}</Tag>\r\n          </Tooltip>\r\n        );\r\n      });\r\n    },\r\n  },\r\n];\r\n\r\nconst RealTimeRaw = ({ requests }: Props) => {\r\n  const uiContext = useContext<TUIContext>(UIContext);\r\n\r\n  useEffect(() => {\r\n    uiContext.setTitle('Real Time');\r\n    uiContext.setSubTitle('See what\\'s happening right now on your web application');\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <Table dataSource={requests} columns={columns} rowKey='unique_id' pagination={false} size=\"small\" />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default connect(mapState)(RealTimeRaw);\r\n","export default __webpack_public_path__ + \"static/media/logo.ab397bc7.svg\";","import { init, RematchDispatch } from '@rematch/core';\r\nimport { realTime, RealTimeState } from 'store/real-time';\r\nimport {dashboard, DashboardState} from \"store/dashboard\";\r\nimport {audit, AuditState} from \"store/audit\";\r\n\r\nexport interface RootModel {\r\n  realTime: typeof realTime,\r\n  dashboard: typeof dashboard,\r\n  audit: typeof audit\r\n}\r\n\r\nconst models: RootModel = {\r\n  realTime,\r\n  dashboard,\r\n  audit\r\n};\r\n\r\nexport const store = init({\r\n  models,\r\n});\r\n\r\nexport type Store = typeof store;\r\nexport type Dispatch = RematchDispatch<RootModel>;\r\n\r\nexport interface RootState {\r\n  realTime: RealTimeState,\r\n  dashboard: DashboardState,\r\n  audit: AuditState\r\n}\r\n","import { createModel } from '@rematch/core';\r\nimport { RootModel } from 'store';\r\nimport { AuditDocument } from 'store/types/audit-document';\r\nimport { cloneDeep } from 'lodash';\r\n\r\nexport interface RealTimeState {\r\n  auditDocuments: AuditDocument[]\r\n}\r\n\r\nexport const realTime = createModel<RootModel>({\r\n  state: {\r\n    auditDocuments: [],\r\n  } as RealTimeState,\r\n  reducers: {\r\n    addAuditDocument(state: RealTimeState, payload: AuditDocument): RealTimeState {\r\n      const auditDocs = state.auditDocuments;\r\n      const existingDocIdx = auditDocs.findIndex(a => a.unique_id === payload.unique_id);\r\n\r\n      if (existingDocIdx === -1) {\r\n        const doc = { ...payload };\r\n        doc.messages = [doc.message!];\r\n        delete doc.message;\r\n\r\n        return {\r\n          ...state,\r\n          auditDocuments: [doc, ...state.auditDocuments],\r\n        };\r\n      }\r\n\r\n      const newDoc = cloneDeep(auditDocs[existingDocIdx]);\r\n      newDoc.messages.push(payload.message!);\r\n      state.auditDocuments.splice(existingDocIdx, 1, newDoc);\r\n\r\n      return {\r\n        ...state,\r\n      };\r\n    },\r\n  },\r\n});\r\n","import { createModel } from '@rematch/core';\r\nimport { RootModel } from 'store';\r\n\r\nexport interface DashboardState {\r\n  charts: {},\r\n  timeRange: {startTime: number, endTime: any},\r\n  autoRefresh: boolean\r\n}\r\n\r\nexport const dashboard = createModel<RootModel>({\r\n  state: {\r\n    charts: {\r\n      blockedAllowed : {data : {}},\r\n      topRules: {data : {labels: [], datasets: []}},\r\n      topHosts: {data : {}},\r\n      topStatusCodes: {data : {}},\r\n      topSeverity: {data : {}},\r\n      topClients: {data: {}},\r\n      rulesPerMinute: {data : {}}\r\n    },\r\n    timeRange: {startTime: Date.now() - 900000, endTime: null},\r\n    autoRefresh: true\r\n  } as DashboardState,\r\n  reducers: {\r\n    setBlockedAllowedData(state, payload) {\r\n      return {\r\n        ...state,\r\n        charts: {...state.charts, blockedAllowed: {data: payload}},\r\n      };\r\n    },\r\n    setTopRules(state, payload) {\r\n      return {\r\n        ...state,\r\n        charts: {...state.charts, topRules: {data: payload}},\r\n      };\r\n    },\r\n    setTopHosts(state, payload) {\r\n      return {\r\n        ...state,\r\n        charts: {...state.charts, topHosts: {data: payload}},\r\n      };\r\n    },\r\n    setTopClients(state, payload) {\r\n      return {\r\n        ...state,\r\n        charts: {...state.charts, topClients: {data: payload}},\r\n      };\r\n    },\r\n    setTopStatusCodes(state, payload) {\r\n      return {\r\n        ...state,\r\n        charts: {...state.charts, topStatusCodes: {data: payload}},\r\n      };\r\n    },\r\n    setTopSeverity(state, payload) {\r\n      return {\r\n        ...state,\r\n        charts: {...state.charts, topSeverity: {data: payload}},\r\n      };\r\n    },\r\n    setRulesPerMinute(state, payload) {\r\n      return {\r\n        ...state,\r\n        charts: {...state.charts, rulesPerMinute: {data: payload}},\r\n      };\r\n    },\r\n    setTimeRange(state, payload) {\r\n\r\n      return {\r\n        ...state,\r\n        autoRefresh: payload.autoRefresh ? payload.autoRefresh : true,\r\n        timeRange: {startTime: payload.value[0].valueOf(), endTime: payload.value[1] !== null ? payload.value[1].valueOf() : null},\r\n      };\r\n    },\r\n  },\r\n});\r\n","import { createModel } from '@rematch/core';\r\nimport { RootModel } from 'store';\r\n\r\nexport interface AuditState {\r\n  dataSource: {data: []},\r\n  timeRange: {startTime: number, endTime: any}\r\n}\r\n\r\nexport const audit = createModel<RootModel>({\r\n  state: {\r\n    dataSource: {data: []},\r\n    timeRange: {startTime: Date.now() - 900000, endTime: null}\r\n  } as AuditState,\r\n  reducers: {\r\n    setData(state, payload) {\r\n      return {\r\n        ...state,\r\n        dataSource: {data : payload.hits.hits},\r\n      };\r\n    },\r\n    setTimeRange(state, payload) {\r\n      return {\r\n        ...state,\r\n        timeRange: {startTime: payload[0].valueOf(), endTime: payload[1] !== null ? payload[1].valueOf() : null},\r\n      };\r\n    },\r\n  },\r\n});\r\n","import { DollarCircleOutlined, DashboardOutlined, FieldTimeOutlined, FundViewOutlined, SettingOutlined, BarsOutlined, ControlOutlined, FileProtectOutlined } from '@ant-design/icons';\r\nimport { Layout, Menu, PageHeader } from 'antd';\r\nimport 'App.less';\r\nimport Audit from 'components/audit/Audit';\r\nimport Protections from 'components/configuration/Protections';\r\nimport Rules from 'components/configuration/Rules';\r\nimport Settings from 'components/configuration/Settings';\r\nimport Upgrade from 'components/upgrade/Upgrade';\r\nimport Dashboard from 'components/dashboard/Dashboard';\r\nimport RealTime from 'components/real-time/RealTime';\r\nimport { UIContext, UIContextProvider } from 'contexts/ui-context';\r\nimport logo from 'logo.svg';\r\n// import { ReactComponent as FireWafLogo } from 'radware.svg';\r\nimport React, { useEffect } from 'react';\r\nimport { Provider } from 'react-redux';\r\nimport { BrowserRouter, Link, Route, Switch } from 'react-router-dom';\r\nimport io from 'socket.io-client';\r\nimport { store } from 'store';\r\n\r\nconst { Content, Sider } = Layout;\r\n\r\nconst App: React.FunctionComponent = () => {\r\n  useEffect(() => {\r\n    const backend_host = process.env.REACT_APP_BACKEND_HOST || 'localhost';\r\n    const socket = io(`http://${backend_host}:8088`);\r\n    socket.on('auditLog', (m: any) => {\r\n      store.dispatch.realTime.addAuditDocument(m);\r\n    });\r\n\r\n    return () => {\r\n      socket.close();\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <BrowserRouter>\r\n      <Provider store={store}>\r\n        <UIContextProvider>\r\n          <Layout style={{ minHeight: '100vh' }}>\r\n            <Sider className=\"menu-sider\" width={300}>\r\n              <div className=\"firewaf-title\">\r\n                <img src={logo} style={{height:'70px'}} alt={'Radware'}/>\r\n                <div>\r\n                  <h3>WAF Lite</h3>\r\n                </div>\r\n              </div>\r\n\r\n              <Menu\r\n                style={{ width: '100%' }}\r\n                defaultSelectedKeys={['1']}\r\n                defaultOpenKeys={['sub1']}\r\n                mode=\"inline\"\r\n                className=\"main-menu\"\r\n              >\r\n                <Menu.Item key={`/`} icon={<DashboardOutlined />}>\r\n                  <Link to={`/`}>Dashboard</Link>\r\n                </Menu.Item>\r\n                <Menu.Item key={`/real-time`} icon={<FieldTimeOutlined />}>\r\n                  <Link to={`/real-time`}>Real Time</Link>\r\n                </Menu.Item>\r\n                <Menu.Item key={`/audit`} icon={<FundViewOutlined />}>\r\n                  <Link to={`/audit`}>Audit</Link>\r\n                </Menu.Item>\r\n                <Menu.SubMenu key=\"config\" icon={<SettingOutlined />} title=\"Configuration\">\r\n                  <Menu.Item key={`/protections`} icon={<FileProtectOutlined />}>\r\n                    <Link to={`/protections`}>Protected Web Apps</Link>\r\n                  </Menu.Item>\r\n                  <Menu.Item key={`/rules`} icon={<BarsOutlined />}>\r\n                    <Link to={`/rules`}>Rules</Link>\r\n                  </Menu.Item>\r\n                  <Menu.Item key={`/settings`} icon={<ControlOutlined />}>\r\n                    <Link to={`/settings`}>Settings</Link>\r\n                  </Menu.Item>\r\n                </Menu.SubMenu>\r\n                <Menu.Item key={`/upgrade`} icon={<DollarCircleOutlined />}>\r\n                  <Link to={`/upgrade`}>Upgrade</Link>\r\n                </Menu.Item>\r\n              </Menu>\r\n            </Sider>\r\n\r\n            <Content>\r\n              <Layout style={{ minHeight: '100vh' }}>\r\n                <UIContext.Consumer>\r\n                  {({ title, subTitle }) => (\r\n                    <PageHeader\r\n                      className=\"global-page-header\"\r\n                      backIcon={false}\r\n                      title={title}\r\n                      subTitle={subTitle}\r\n                    />\r\n                  )}\r\n                </UIContext.Consumer>\r\n\r\n                <Content className=\"main-content\">\r\n                  <Switch>\r\n                    <Route path=\"/upgrade\" component={Upgrade}/>\r\n                    <Route path=\"/real-time\" component={RealTime} />\r\n                    <Route path=\"/audit\" component={Audit} />\r\n                    <Route path=\"/protections\" component={Protections} />\r\n                    <Route path=\"/rules\" component={Rules} />\r\n                    <Route path=\"/settings\" component={Settings} />\r\n                    <Route path=\"/\" component={Dashboard} />\r\n                  </Switch>\r\n                </Content>\r\n              </Layout>\r\n            </Content>\r\n          </Layout>\r\n        </UIContextProvider>\r\n      </Provider>\r\n    </BrowserRouter>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport './index.scss';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root'),\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}