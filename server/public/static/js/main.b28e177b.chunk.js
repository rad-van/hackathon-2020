(this.webpackJsonpwafui=this.webpackJsonpwafui||[]).push([[0],{248:function(e,t,a){},439:function(e,t,a){},440:function(e,t,a){"use strict";a.r(t);var s=a(7),i=a(0),n=a.n(i),r=a(36),o=a.n(r),c=a(452),l=a(453),d=a(454),u=a(455),p=a(456),j=a(457),g=a(458),b=a(459),O=a(443),h=a(61),T=a(448),m=(a(248),a(174)),f=n.a.createContext({title:"",setTitle:function(){},subTitle:"",setSubTitle:function(){}}),x=function(e){var t=e.children,a=n.a.useState(""),i=Object(m.a)(a,2),r=i[0],o=i[1],c=n.a.useState(""),l=Object(m.a)(c,2),d={title:r,setTitle:o,subTitle:l[0],setSubTitle:l[1]};return Object(s.jsx)(f.Provider,{value:d,children:t})},y=a(445),A=a(82),S=a(108),E=a(57),R=a(444),I=a(447),P={options:{legend:{display:!1},scales:{xAxes:[{gridLines:{display:!1}}],yAxes:[{gridLines:{display:!1},ticks:{beginAtZero:!0,stepSize:1}}]},maintainAspectRatio:!1},request:{labels:["Allowed","Blocked"],aggregation:!0,type:"horizontal-bar",query:{size:0,aggs:{aggName:{terms:{field:"status.keyword"},aggs:{count:{value_count:{field:"status.keyword"}}}}}}}},C={options:{legend:{display:!1},scales:{xAxes:[{gridLines:{display:!1},ticks:{beginAtZero:!0,stepSize:1}}],yAxes:[{ticks:{autoSkip:!1,fontFamily:"Roboto, Areal, sans-serif"},gridLines:{display:!1}}]},maintainAspectRatio:!1},request:{aggregation:!0,type:"horizontal-bar",query:{size:0,aggs:{aggName:{terms:{field:"message.details.ruleId.keyword"},aggs:{count:{value_count:{field:"message.details.ruleId.keyword"}}}}}}}},v={options:{legend:{position:"left"},scales:{xAxes:[{display:!1,gridLines:{display:!1}}],yAxes:[{display:!1,gridLines:{display:!1}}]},maintainAspectRatio:!1},request:{aggregation:!0,type:"doughnut",query:{size:0,aggs:{aggName:{terms:{field:"response.http_code"},aggs:{count:{value_count:{field:"response.http_code"}}}}}}}},L={options:{legend:{display:!1},scales:{xAxes:[{gridLines:{display:!1},ticks:{stepSize:1,beginAtZero:!0}}],yAxes:[{gridLines:{display:!1}}]},maintainAspectRatio:!1},request:{aggregation:!0,type:"horizontal-bar",query:{size:0,aggs:{aggName:{terms:{field:"message.details.severity.keyword"},aggs:{count:{value_count:{field:"message.details.severity.keyword"}}}}}}}},N={options:{maintainAspectRatio:!1,legend:{display:!1},scales:{xAxes:[{gridLines:{display:!1},type:"time",time:{unit:"minute"},distribution:"series"}],yAxes:[{gridLines:{display:!1},ticks:{stepSize:1,beginAtZero:!0}}]}},request:{aggregation:!0,type:"time",query:{size:0,aggs:{aggName:{date_histogram:{field:"time_stamp",fixed_interval:"5m",min_doc_count:1},aggs:{count:{cardinality:{field:"unique_id.keyword"}}}}}}}},w={options:{legend:{position:"left"},scales:{xAxes:[{display:!1,gridLines:{display:!1}}],yAxes:[{display:!1,gridLines:{display:!1}}]},maintainAspectRatio:!1},request:{aggregation:!0,type:"horizontal-bar",query:{size:0,aggs:{aggName:{terms:{field:"client_ip.keyword"},aggs:{count:{value_count:{field:"client_ip.keyword"}}}}}}}},_={request:{aggregation:!1,query:{size:5e3,sort:{time_stamp:{order:"desc"}}}}},k=function(e,t,a){a.startTime&&a.endTime?e.request.query.query={bool:{must:[{range:{time_stamp:{gte:a.startTime,lte:a.endTime}}}]}}:a.startTime&&(e.request.query.query={bool:{must:[{range:{time_stamp:{gte:a.startTime}}}]}});var s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.request)},i=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_HOST||"localhost";console.log(s),fetch("http://".concat(i,":8088/history"),s).then((function(e){return e.json().then((function(e){console.log(e),t(e)}))}))},D=a(38),q=a.n(D),U=a(81),K=y.a.RangePicker,H=Object(U.b)((function(e){return{dataSource:e.audit.dataSource,timeRange:e.audit.timeRange}}),(function(e){return{setData:e.audit.setData,setTimeRange:e.audit.setTimeRange}}))((function(e){var t=Object(i.useContext)(f),a=Object(i.useState)({date:[]}).data,n=[{title:"Date & Time",dataIndex:"time_stamp",render:function(e,t){return q()(t._source.time_stamp).format("ll LTS")}},{title:"Source",dataIndex:"client_ip",render:function(e,t){return"".concat(t._source.client_ip,":").concat(t._source.client_port)},filtered:!0},{title:"URL",dataIndex:["request","uri"],ellipsis:{showTitle:!1},render:function(e,t){return Object(s.jsx)(A.a,{title:t._source.request.uri,placement:"topLeft",children:t._source.request.uri})}},{title:"Status Code",dataIndex:["response","http_code"],render:function(e,t){return t._source.response.http_code},filtered:!0},{title:"Severity",dataIndex:["message","message","details","severity"],render:function(e,t){return t._source.message?t._source.message.details.severity:"None"}},{title:"Rule ID",dataIndex:["message","message","details","ruleId"]}];return Object(i.useEffect)((function(){t.setTitle("Audit"),t.setSubTitle("Inspect your web application security in depth"),console.log(e.timeRange),function(e,t,a){a.startTime&&a.endTime?e.request.query.query={bool:{must:[{range:{time_stamp:{gte:a.startTime,lte:a.endTime}}}]}}:a.startTime&&(e.request.query.query={bool:{must:[{range:{time_stamp:{gte:a.startTime}}}]}});var s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.request)},i=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_HOST||"localhost";console.log(s),fetch("http://".concat(i,":8088/history"),s).then((function(e){return e.json().then((function(e){console.log(e),t(e)}))}))}(_,e.setData,e.timeRange)}),[a,e.timeRange]),Object(i.useEffect)((function(){return function(){var t=[q()(Date.now()-9e5),null];e.setTimeRange(t)}}),[]),Object(s.jsxs)("div",{children:[Object(s.jsx)(S.a,{children:Object(s.jsx)(E.a,{span:6,offset:18,children:Object(s.jsx)(K,{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",onOk:function(t){2===t.length&&null!==t[0]&&null!==t[1]&&e.setTimeRange(t)}})})}),Object(s.jsx)(R.a,{dataSource:e.dataSource.data?e.dataSource.data:[],columns:n,rowKey:function(e){return e._id},expandable:{expandedRowRender:function(e){return Object(s.jsx)(I.a,{children:Object(s.jsxs)("p",{style:{margin:50},children:["Host IP: ",e._source.host_ip,Object(s.jsx)("br",{}),"Message: ",e._source.message.message,Object(s.jsx)("br",{}),"Rule Data: ",e._source.message.details.data,Object(s.jsx)("br",{}),"Rule Conf File: ",e._source.message.details.file,Object(s.jsx)("br",{})]})})},rowExpandable:function(e){return e._source.message}},pagination:{defaultPageSize:25,showSizeChanger:!0}})]})})),M=a(450),F=[{name:"radware.buzz",ip:"11.61.16.6",port:443,protocol:"HTTPS",enabled:!0},{name:"github.army",ip:"116.611.161.6",port:443,protocol:"HTTPS",enabled:!0},{name:"hiho.io",ip:"77.77.1.1",port:80,protocol:"HTTP",enabled:!0}],Q=function(){var e=Object(i.useContext)(f);Object(i.useEffect)((function(){e.setTitle("Web Applications"),e.setSubTitle("Protect your web applications")}));var t=[{title:"Name",dataIndex:"name",key:"name"},{title:"IP",dataIndex:"ip",key:"ip"},{title:"Port",dataIndex:"port",key:"port"},{title:"Protocol",dataIndex:"protocol",key:"protocol"},{title:"Enabled",dataIndex:"enabled",render:function(e,t){return Object(s.jsx)(M.a,{defaultChecked:e})}}];return Object(s.jsx)("div",{children:Object(s.jsx)(R.a,{dataSource:F,columns:t,rowKey:"name"})})},G=a(451),z=a(71),B=function(){var e=Object(i.useContext)(f),t=[{title:"Rule",dataIndex:"rule"},{title:"Type",dataIndex:"type"},{title:"Rule Group",dataIndex:"group"},{title:"Rule Group",dataIndex:"group"},{title:"Enabled",dataIndex:"enabled",render:function(e,t){return Object(s.jsx)(M.a,{defaultChecked:e})}}];return Object(i.useEffect)((function(){e.setTitle("Rules"),e.setSubTitle("Fine tune your firewall rules")})),Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{children:"List of OWASP Top 10 rules to enable/disable"}),Object(s.jsx)(S.a,{children:Object(s.jsx)(E.a,{span:6,offset:18,children:Object(s.jsxs)(G.b,{children:[Object(s.jsx)(z.a,{type:"primary",children:"Add New Rule"}),Object(s.jsx)(z.a,{type:"primary",children:"Purchase Radware Rule Set"})]})})}),Object(s.jsx)(R.a,{columns:t,dataSource:[{rule:"INITIALIZATION",group:"901",type:"Request",enabled:!0},{rule:"DRUPAL-EXCLUSION-RULES",group:"903.9001",type:"Request",enabled:!0},{rule:"WORDPRESS-EXCLUSION-RULES",group:"903.9002",type:"Request",enabled:!0},{rule:"NEXTCLOUD-EXCLUSION-RULES",group:"903.9003",type:"Request",enabled:!0},{rule:"DOKUWIKI-EXCLUSION-RULES",group:"903.9004",type:"Request",enabled:!0},{rule:"CPANEL-EXCLUSION-RULES",group:"903.9005",type:"Request",enabled:!0},{rule:"COMMON-EXCEPTIONS",group:"905",type:"Request",enabled:!0},{rule:"IP-REPUTATION",group:"910",type:"Request",enabled:!0},{rule:"METHOD-ENFORCEMENT",group:"911",type:"Request",enabled:!0},{rule:"DOS-PROTECTIONT",group:"912",type:"Request",enabled:!0},{rule:"SCANNER-DETECTION",group:"913",type:"Request",enabled:!0},{rule:"PROTOCOL-ENFORCEMENT",group:"920",type:"Request",enabled:!0},{rule:"PROTOCOL-ENFORCEMENT",group:"920",type:"Request",enabled:!0},{rule:"PROTOCOL-ENFORCEMENT",group:"920",type:"Request",enabled:!0},{rule:"PROTOCOL-ENFORCEMENT",group:"920",type:"Request",enabled:!0},{rule:"PROTOCOL-ATTACK",group:"921",type:"Request",enabled:!0},{rule:"APPLICATION-ATTACK-LFIT",group:"930",type:"Request",enabled:!0},{rule:"APPLICATION-ATTACK-RFI",group:"931",type:"Request",enabled:!0},{rule:"APPLICATION-ATTACK-RCE",group:"932",type:"Request",enabled:!0},{rule:"APPLICATION-ATTACK-PHP",group:"933",type:"Request",enabled:!0},{rule:"APPLICATION-ATTACK-XSS",group:"941",type:"Request",enabled:!0},{rule:"APPLICATION-ATTACK-SQLI",group:"942",type:"Request",enabled:!0},{rule:"APPLICATION-ATTACK-SESSION-FIXATION",group:"943",type:"Request",enabled:!0},{rule:"APPLICATION-ATTACK-JAVA",group:"944",type:"Request",enabled:!0},{rule:"BLOCKING-EVALUATION",group:"949",type:"Request",enabled:!0},{rule:"DATA-LEAKAGES",group:"950",type:"Response",enabled:!0},{rule:"DATA-LEAKAGES-SQL",group:"951",type:"Response",enabled:!0},{rule:"DATA-LEAKAGES-JAVA",group:"952",type:"Response",enabled:!0},{rule:"DATA-LEAKAGES-PHP",group:"953",type:"Response",enabled:!0},{rule:"DATA-LEAKAGES-IIS",group:"954",type:"Response",enabled:!0},{rule:"LOCKING-EVALUATION",group:"959",type:"Response",enabled:!0},{rule:"CORRELATION",group:"980",type:"Response",enabled:!0}],pagination:{defaultPageSize:10,showSizeChanger:!0}})]})},W=a(14),J=a(122),V=a(446),X=a(449),Y=J.a.Option,Z=function(){var e=Object(i.useContext)(f);Object(i.useEffect)((function(){e.setTitle("Settings"),e.setSubTitle("Configure the WAF Proxy")}));return Object(s.jsxs)(V.a,Object(W.a)(Object(W.a)({},{labelCol:{span:4},wrapperCol:{span:8}}),{},{children:[Object(s.jsx)(V.a.Item,{label:"Number of Threads",children:Object(s.jsxs)(J.a,{defaultValue:"auto",children:[Object(s.jsx)(Y,{value:"auto",children:"Auto"}),Object(s.jsx)(Y,{value:"1",children:"1"}),Object(s.jsx)(Y,{value:"2",children:"2"}),Object(s.jsx)(Y,{value:"4",children:"4"}),Object(s.jsx)(Y,{value:"8",children:"8"})]})}),Object(s.jsx)(V.a.Item,{label:"Connections Per Thread",children:Object(s.jsx)(X.a,{min:1024,max:8192,step:1024,defaultValue:4096})}),Object(s.jsx)(V.a.Item,{label:"Log level",children:Object(s.jsxs)(J.a,{defaultValue:"warn",children:[Object(s.jsx)(Y,{value:"warn",children:"Warning"}),Object(s.jsx)(Y,{value:"error",children:"Error"}),Object(s.jsx)(Y,{value:"crit",children:"Critical"}),Object(s.jsx)(Y,{value:"alert",children:"Alert"}),Object(s.jsx)(Y,{value:"emerg",children:"Emergency"})]})}),Object(s.jsx)(V.a.Item,{label:"Check Response Bodies",children:Object(s.jsx)(M.a,{defaultChecked:!0})}),Object(s.jsx)(V.a.Item,Object(W.a)(Object(W.a)({},{wrapperCol:{offset:4,span:8}}),{},{children:Object(s.jsx)(z.a,{type:"primary",htmlType:"submit",children:"Submit"})}))]}))},$=function(){var e=Object(i.useContext)(f);return Object(i.useEffect)((function(){e.setTitle("Upgrade"),e.setSubTitle("Upgrade your firewall to Radware's professional WAF")})),Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{style:{marginBottom:"30px"},children:Object(s.jsx)("a",{href:"https://www.radware.com",rel:"noreferrer",target:"_blank",children:"Upgrade to Radware Premium Ruleset"})}),Object(s.jsx)("div",{children:Object(s.jsx)("a",{href:"https://www.radware.com/products/cloud-waf-service/",rel:"noreferrer",target:"_blank",children:"Upgrade to Professional Radware Products"})})]})},ee=a(240),te=a(72),ae=a(92),se=a(56),ie={10:{display:!1,category:"REQUEST-10-GEO-IP-DATA",title:"Geo IP Data",description:"Geo IP Data",tagText:"GEO-IP-DATA"},901:{display:!1,category:"REQUEST-901-INITIALIZATION",title:"CRS Initialization",description:"Initializes the Core Rules and performs preparatory actions. It also fixes errors and omissions of variable definitions in the setup file."},905:{display:!1,category:"REQUEST-905-COMMON-EXCEPTIONS",title:"Common exceptions",description:"Used as an exception mechanism to remove common false positives that may be encountered."},910:{display:!0,category:"REQUEST-910-IP-REPUTATION",title:"IP Reputation and Geo IP",description:"Uses data from previous requests, ProjectHoneypot's block list and Geo IP data to determine the level of risk presented by the user.",tagText:"IP-REPUTATION"},911:{display:!0,category:"REQUEST-911-METHOD-ENFORCEMENT",title:"HTTP Methods",description:"Blocks requests with forbidden HTTP methods PUT and PATCH.",tagText:"HTTP-METHOD"},912:{display:!0,category:"REQUEST-912-DOS-PROTECTION",title:"Denial of Service",description:"Anti-Automation rules to detect Denial of Service attacks.",tagText:"DoS"},913:{display:!0,category:"REQUEST-913-SCANNER-DETECTION",title:"Port and environment scanners",description:"Protection against port and environment scanners like security scanners, scripted HTTP clients, web crawlers and bots.",tagText:"SCANNER"},920:{display:!0,category:"REQUEST-920-PROTOCOL-ENFORCEMENT",title:"HTTP Protocol Violation",description:"Protection against common HTTP protocol violations used in application layer attacks by validating HTTP requests against HTTP RFC.",tagText:"PROTOCOL-INVALID"},921:{display:!0,category:"REQUEST-921-PROTOCOL-ATTACK",title:"HTTP Protocol Attack",description:"Protection against header injection, request smuggling, response splitting and parameter pollution.",tagText:"PROTOCOL-ATTACK"},930:{display:!0,category:"REQUEST-930-APPLICATION-ATTACK-LFI",title:"Local File Inclusion",description:"Protection against directory and path traversal attacks, OS file access and restricted file access.",tagText:"FILE-PATH"},931:{display:!0,category:"REQUEST-931-APPLICATION-ATTACK-RFI",title:"Remote File Inclusion",description:"Protection against common types of remote file inclusion (RFI) attack methods like URL parameter using IP address, common RFI vulnerable parameter name used in URL payload, data ends with question mark(s), off-domain reference/kink.",tagText:"REMOTE-FILE"},932:{display:!0,category:"REQUEST-932-APPLICATION-ATTACK-RCE",title:"Remote Command Execution",description:"Protection against remote code execution attacks for Unix and Windows with Shell and PowerShell commands injection, and protection against Shellshock (CVE-2014-6271).",tagText:"REMOTE-COMMAND"},933:{display:!0,category:"REQUEST-933-APPLICATION-ATTACK-PHP",title:"PHP Injection",description:"Protection against PHP injection attacks like opening/closing tag, script file upload, configuration directive, variables, I/O stream and function name and call.",tagText:"PHP"},934:{display:!0,category:"REQUEST-934-APPLICATION-ATTACK-NODEJS",title:"NodeJs Injection",description:"Protection against NodeJs injection attacks like insecure unserialization and generic RCE signatures.",tagText:"NODEJS"},941:{display:!0,category:"REQUEST-941-APPLICATION-ATTACK-XSS",title:"Cross-Site Scripting",description:"Protection against a wide range of cross-site scripting attacks.",tagText:"XSS"},942:{display:!0,category:"REQUEST-942-APPLICATION-ATTACK-SQLI",title:"SQL Injection",description:"Protection against a wide range of SQL injection attacks.",tagText:"SQL"},943:{display:!0,category:"REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION",title:"Session Fixation",description:"Protection against session fixation attacks through cookies and parameters.",tagText:"SESSION"},944:{display:!0,category:"REQUEST-944-APPLICATION-ATTACK-JAVA",title:"Java Attack",description:"Protection against common Java attacks like payload execution, remote command execution, common Java classes, functions and keywords and known vulnerabilities in Apache Struts and Java deserialization.",tagText:"JAVA"},949:{display:!1,category:"REQUEST-949-BLOCKING-EVALUATION",title:"Request Blocking Evaluation",description:"Evaluating the action to take on the request based on the calculated anomaly score and IP reputation checks."},950:{display:!0,category:"RESPONSE-950-DATA-LEAKAGES",title:"Data Leakage",description:"Protection against data leakages in the response like directory listing, CGI source code and application status information.",tagText:"DATA-LEAK"},951:{display:!0,category:"RESPONSE-951-DATA-LEAKAGES-SQL",title:"SQL Leakage",description:"Protection against SQL error message leakages for multiple SQL databases (MySQL, PostgreSQL, MS Access, Oracle, sqlite, and many More).",tagText:"SQL-LEAK"},952:{display:!0,category:"RESPONSE-952-DATA-LEAKAGES-JAVA",title:"Java Leakage",description:"Protection against Java source code and error message leakages.",tagText:"JAVA-LEAK"},953:{display:!0,category:"RESPONSE-953-DATA-LEAKAGES-PHP",title:"PHP Leakage",description:"Protection against PHP source code and error message leakages.",tagText:"PHP-LEAK"},954:{display:!0,category:"RESPONSE-954-DATA-LEAKAGES-IIS",title:"IIS Leakage",description:"Protection against sensitive information leakages for Microsoft IIS server, like server default location and error messages.",tagText:"IIS-LEAK"},959:{display:!1,category:"RESPONSE-959-BLOCKING-EVALUATION",title:"Response Blocking Evaluation",description:"Evaluating the action to take on the response based on the calculated anomaly score."},980:{display:!1,category:"RESPONSE-980-CORRELATION",title:"Response Post Processing",description:"Post processing after the response has been sent to the client (in the logging phase). Its purpose is to provide inbound + outbound correlation of events to provide a more intelligent designation as to the outcome or result of the transaction."}};function ne(e){var t=Object.keys(ie).find((function(t){return e.startsWith(t)}));return t?ie[t]:{display:!1,category:"UNKNOWN",title:"Unknown",description:"Unknown rule."}}var re=y.a.RangePicker,oe=0,ce=Object(U.b)((function(e){return{charts:e.dashboard.charts,timeRange:e.dashboard.timeRange,realTimeRequests:e.realTime.auditDocuments.filter((function(e){return"Blocked"===e.status})).slice(0,5),autoRefresh:e.dashboard.autoRefresh}}),(function(e){return{setBlockedAllowedData:e.dashboard.setBlockedAllowedData,setTopRules:e.dashboard.setTopRules,setTopClients:e.dashboard.setTopClients,setTopStatusCodes:e.dashboard.setTopStatusCodes,setTopSeverity:e.dashboard.setTopSeverity,setRulesPerMinute:e.dashboard.setRulesPerMinute,setTimeRange:e.dashboard.setTimeRange}}))((function(e){var t=Object(i.useContext)(f),a=Object(i.useState)({}).charts;Object(i.useEffect)((function(){t.setTitle("Dashboard"),t.setSubTitle("General overview of your web application's security"),k(P,e.setBlockedAllowedData,e.timeRange),k(C,e.setTopRules,e.timeRange),k(w,e.setTopClients,e.timeRange),k(v,e.setTopStatusCodes,e.timeRange),k(L,e.setTopSeverity,e.timeRange),k(N,e.setRulesPerMinute,e.timeRange)}),[a,e.timeRange]),Object(i.useEffect)((function(){return function(){var t=[q()(Date.now()-9e5),null];e.setTimeRange({value:t})}}),[]),Object(i.useEffect)((function(){if(e.autoRefresh)return console.log(e.autoRefresh),oe=setInterval((function(){var t=[q()(Date.now()-9e5),null];e.setTimeRange({value:t})}),1e4),function(){return clearInterval(oe)}}),[e.autoRefresh]);var n=[{title:"Time",dataIndex:"time_stamp",render:function(e){return q()(e).format("LTS")}},{title:"Source",dataIndex:"client_ip",render:function(e,t){return t.request.headers[55555]?t.request.headers[55555]:e}},{title:"URL",dataIndex:["request","uri"],ellipsis:{showTitle:!1},render:function(e){return Object(s.jsx)(A.a,{title:e,placement:"topLeft",children:e})}},{title:"Attacks",dataIndex:["messages"],render:function(e,t){var a={},i=t.messages.map((function(e){return ne(e.details.ruleId)})).filter((function(e){return e.display&&e.tagText})).map((function(e){return a[e.tagText]=e.title,e.tagText}));return Array.from(new Set(i)).map((function(e){return Object(s.jsx)(A.a,{title:a[e],children:Object(s.jsx)(ee.a,{color:"red",children:e})})}))}}];return Object(s.jsxs)("div",{children:[Object(s.jsx)(S.a,{children:Object(s.jsx)(E.a,{span:6,offset:18,children:Object(s.jsx)(re,{showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",onOk:function(t){2===t.length&&null!==t[0]&&null!==t[1]&&(clearInterval(oe),e.setTimeRange({value:t,autoRefresh:!1}))}})})}),Object(s.jsx)(S.a,{children:Object(s.jsx)(E.a,{span:24,children:Object(s.jsx)(I.a,{title:"Total Requests",children:e.charts.rulesPerMinute.data&&e.charts.rulesPerMinute.data.datasets&&e.charts.rulesPerMinute.data.datasets.length>0?Object(s.jsx)(ae.Line,{data:e.charts.rulesPerMinute.data,height:300,width:100,options:N.options}):Object(s.jsx)("div",{style:{width:"auto",height:300,display:"flex",justifyContent:"center",alignItems:"center"},children:Object(s.jsx)(te.a,{image:te.a.PRESENTED_IMAGE_SIMPLE})})})})}),Object(s.jsxs)(S.a,{children:[Object(s.jsx)(E.a,{span:12,children:Object(s.jsx)(I.a,{title:"Blocked and Allowed Requests",children:e.charts.blockedAllowed.data&&e.charts.blockedAllowed.data.datasets&&e.charts.blockedAllowed.data.datasets.length>0?Object(s.jsx)(ae.Bar,{data:e.charts.blockedAllowed.data,height:300,width:100,options:P.options}):Object(s.jsx)("div",{style:{width:"auto",height:300,display:"flex",justifyContent:"center",alignItems:"center"},children:Object(s.jsx)(te.a,{image:te.a.PRESENTED_IMAGE_SIMPLE})})})}),Object(s.jsx)(E.a,{span:12,children:Object(s.jsx)(I.a,{title:"Top Rules",children:e.charts.topRules.data&&e.charts.topRules.data.datasets&&e.charts.topRules.data.datasets.length>0?Object(s.jsx)(ae.HorizontalBar,{data:{datasets:e.charts.topRules.data.datasets,labels:e.charts.topRules.data.labels.map((function(e){return e+"-"+ne(e).title}))},height:300,width:100,options:C.options}):Object(s.jsx)("div",{style:{width:"auto",height:300,display:"flex",justifyContent:"center",alignItems:"center"},children:Object(s.jsx)(te.a,{image:te.a.PRESENTED_IMAGE_SIMPLE})})})})]}),Object(s.jsxs)(S.a,{children:[Object(s.jsx)(E.a,{span:12,children:Object(s.jsx)(I.a,{title:"Top Clients",children:e.charts.topClients.data&&e.charts.topClients.data.datasets&&e.charts.topClients.data.datasets.length>0?Object(s.jsx)(ae.Doughnut,{data:e.charts.topClients.data,height:300,width:100,options:w.options}):Object(s.jsx)("div",{style:{width:"auto",height:300,display:"flex",justifyContent:"center",alignItems:"center"},children:Object(s.jsx)(te.a,{image:te.a.PRESENTED_IMAGE_SIMPLE})})})}),Object(s.jsx)(E.a,{span:12,children:Object(s.jsx)(I.a,{title:"Top Status Codes",children:e.charts.topStatusCodes.data&&e.charts.topStatusCodes.data.datasets&&e.charts.topStatusCodes.data.datasets.length>0?Object(s.jsx)(ae.Doughnut,{data:e.charts.topStatusCodes.data,height:300,width:100,options:v.options}):Object(s.jsx)("div",{style:{width:"auto",height:300,display:"flex",justifyContent:"center",alignItems:"center"},children:Object(s.jsx)(te.a,{image:te.a.PRESENTED_IMAGE_SIMPLE})})})})]}),Object(s.jsxs)(S.a,{children:[Object(s.jsx)(E.a,{span:12,children:Object(s.jsx)(I.a,{title:"Top Severity",children:e.charts.topSeverity.data&&e.charts.topSeverity.data.datasets&&e.charts.topSeverity.data.datasets.length>0?Object(s.jsx)(ae.HorizontalBar,{data:e.charts.topSeverity.data,height:300,width:100,options:L.options}):Object(s.jsx)("div",{style:{width:"auto",height:300,display:"flex",justifyContent:"center",alignItems:"center"},children:Object(s.jsx)(te.a,{image:te.a.PRESENTED_IMAGE_SIMPLE})})})}),Object(s.jsx)(E.a,{span:12,children:Object(s.jsx)(I.a,{title:"Real Time Attacks",extra:Object(s.jsx)(se.b,{to:"/audit",children:"See All"}),style:{height:"100%"},children:Object(s.jsx)(R.a,{dataSource:e.realTimeRequests,columns:n,rowKey:"unique_id",pagination:!1,size:"small"})})})]})]})})),le=[{title:"Date & Time",dataIndex:"time_stamp",render:function(e){return q()(e).format("ll LTS")}},{title:"Source",dataIndex:"client_ip",render:function(e,t){return t.request.headers[55555]?t.request.headers[55555]:e},filtered:!0},{title:"URL",dataIndex:["request","uri"],ellipsis:{showTitle:!1},render:function(e){return Object(s.jsx)(A.a,{title:e,placement:"topLeft",children:e})}},{title:"Status Code",dataIndex:["response","http_code"]},{title:"Attacks",dataIndex:["messages"],render:function(e,t){var a={},i=t.messages.map((function(e){return ne(e.details.ruleId)})).filter((function(e){return e.display&&e.tagText})).map((function(e){return a[e.tagText]=e.title,e.tagText}));return Array.from(new Set(i)).map((function(e){return Object(s.jsx)(A.a,{title:a[e],children:Object(s.jsx)(ee.a,{color:"red",children:e})})}))}}],de=Object(U.b)((function(e){return{requests:e.realTime.auditDocuments.filter((function(e){return"Blocked"===e.status})).slice(0,10)}}))((function(e){var t=e.requests,a=Object(i.useContext)(f);return Object(i.useEffect)((function(){a.setTitle("Real Time"),a.setSubTitle("See what's happening right now on your web application")})),Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(R.a,{dataSource:t,columns:le,rowKey:"unique_id",pagination:!1,size:"small"})})})),ue=a.p+"static/media/logo.ab397bc7.svg",pe=a(34),je=a(232),ge=a.n(je),be=a(80),Oe=a(238),he=a(233),Te={realTime:Object(be.createModel)({state:{auditDocuments:[]},reducers:{addAuditDocument:function(e,t){var a=e.auditDocuments,s=a.findIndex((function(e){return e.unique_id===t.unique_id}));if(-1===s){var i=Object(W.a)({},t);return i.messages=[i.message],delete i.message,Object(W.a)(Object(W.a)({},e),{},{auditDocuments:[i].concat(Object(Oe.a)(e.auditDocuments))})}var n=Object(he.cloneDeep)(a[s]);return n.messages.push(t.message),e.auditDocuments.splice(s,1,n),Object(W.a)({},e)}}}),dashboard:Object(be.createModel)({state:{charts:{blockedAllowed:{data:{}},topRules:{data:{labels:[],datasets:[]}},topHosts:{data:{}},topStatusCodes:{data:{}},topSeverity:{data:{}},topClients:{data:{}},rulesPerMinute:{data:{}}},timeRange:{startTime:Date.now()-9e5,endTime:null},autoRefresh:!0},reducers:{setBlockedAllowedData:function(e,t){return Object(W.a)(Object(W.a)({},e),{},{charts:Object(W.a)(Object(W.a)({},e.charts),{},{blockedAllowed:{data:t}})})},setTopRules:function(e,t){return Object(W.a)(Object(W.a)({},e),{},{charts:Object(W.a)(Object(W.a)({},e.charts),{},{topRules:{data:t}})})},setTopHosts:function(e,t){return Object(W.a)(Object(W.a)({},e),{},{charts:Object(W.a)(Object(W.a)({},e.charts),{},{topHosts:{data:t}})})},setTopClients:function(e,t){return Object(W.a)(Object(W.a)({},e),{},{charts:Object(W.a)(Object(W.a)({},e.charts),{},{topClients:{data:t}})})},setTopStatusCodes:function(e,t){return Object(W.a)(Object(W.a)({},e),{},{charts:Object(W.a)(Object(W.a)({},e.charts),{},{topStatusCodes:{data:t}})})},setTopSeverity:function(e,t){return Object(W.a)(Object(W.a)({},e),{},{charts:Object(W.a)(Object(W.a)({},e.charts),{},{topSeverity:{data:t}})})},setRulesPerMinute:function(e,t){return Object(W.a)(Object(W.a)({},e),{},{charts:Object(W.a)(Object(W.a)({},e.charts),{},{rulesPerMinute:{data:t}})})},setTimeRange:function(e,t){return Object(W.a)(Object(W.a)({},e),{},{autoRefresh:!t.autoRefresh||t.autoRefresh,timeRange:{startTime:t.value[0].valueOf(),endTime:null!==t.value[1]?t.value[1].valueOf():null}})}}}),audit:Object(be.createModel)({state:{dataSource:{data:[]},timeRange:{startTime:Date.now()-9e5,endTime:null}},reducers:{setData:function(e,t){return Object(W.a)(Object(W.a)({},e),{},{dataSource:{data:t.hits.hits}})},setTimeRange:function(e,t){return Object(W.a)(Object(W.a)({},e),{},{timeRange:{startTime:t[0].valueOf(),endTime:null!==t[1]?t[1].valueOf():null}})}}})},me=Object(be.init)({models:Te}),fe=O.a.Content,xe=O.a.Sider,ye=function(){return Object(i.useEffect)((function(){var e=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_HOST||"localhost",t=ge()("http://".concat(e,":8088"));return t.on("auditLog",(function(e){me.dispatch.realTime.addAuditDocument(e)})),function(){t.close()}}),[]),Object(s.jsx)(se.a,{children:Object(s.jsx)(U.a,{store:me,children:Object(s.jsx)(x,{children:Object(s.jsxs)(O.a,{style:{minHeight:"100vh"},children:[Object(s.jsxs)(xe,{className:"menu-sider",width:300,children:[Object(s.jsxs)("div",{className:"firewaf-title",children:[Object(s.jsx)("img",{src:ue,style:{height:"70px"},alt:"Radware"}),Object(s.jsx)("div",{children:Object(s.jsx)("h3",{children:"WAF Lite"})})]}),Object(s.jsxs)(h.a,{style:{width:"100%"},defaultSelectedKeys:["1"],defaultOpenKeys:["sub1"],mode:"inline",className:"main-menu",children:[Object(s.jsx)(h.a.Item,{icon:Object(s.jsx)(c.a,{}),children:Object(s.jsx)(se.b,{to:"/",children:"Dashboard"})},"/"),Object(s.jsx)(h.a.Item,{icon:Object(s.jsx)(l.a,{}),children:Object(s.jsx)(se.b,{to:"/real-time",children:"Real Time"})},"/real-time"),Object(s.jsx)(h.a.Item,{icon:Object(s.jsx)(d.a,{}),children:Object(s.jsx)(se.b,{to:"/audit",children:"Audit"})},"/audit"),Object(s.jsxs)(h.a.SubMenu,{icon:Object(s.jsx)(u.a,{}),title:"Configuration",children:[Object(s.jsx)(h.a.Item,{icon:Object(s.jsx)(p.a,{}),children:Object(s.jsx)(se.b,{to:"/protections",children:"Protected Web Apps"})},"/protections"),Object(s.jsx)(h.a.Item,{icon:Object(s.jsx)(j.a,{}),children:Object(s.jsx)(se.b,{to:"/rules",children:"Rules"})},"/rules"),Object(s.jsx)(h.a.Item,{icon:Object(s.jsx)(g.a,{}),children:Object(s.jsx)(se.b,{to:"/settings",children:"Settings"})},"/settings")]},"config"),Object(s.jsx)(h.a.Item,{icon:Object(s.jsx)(b.a,{}),children:Object(s.jsx)(se.b,{to:"/upgrade",children:"Upgrade"})},"/upgrade")]})]}),Object(s.jsx)(fe,{children:Object(s.jsxs)(O.a,{style:{minHeight:"100vh"},children:[Object(s.jsx)(f.Consumer,{children:function(e){var t=e.title,a=e.subTitle;return Object(s.jsx)(T.a,{className:"global-page-header",backIcon:!1,title:t,subTitle:a})}}),Object(s.jsx)(fe,{className:"main-content",children:Object(s.jsxs)(pe.c,{children:[Object(s.jsx)(pe.a,{path:"/upgrade",component:$}),Object(s.jsx)(pe.a,{path:"/real-time",component:de}),Object(s.jsx)(pe.a,{path:"/audit",component:H}),Object(s.jsx)(pe.a,{path:"/protections",component:Q}),Object(s.jsx)(pe.a,{path:"/rules",component:B}),Object(s.jsx)(pe.a,{path:"/settings",component:Z}),Object(s.jsx)(pe.a,{path:"/",component:ce})]})})]})})]})})})})},Ae=(a(439),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,460)).then((function(t){var a=t.getCLS,s=t.getFID,i=t.getFCP,n=t.getLCP,r=t.getTTFB;a(e),s(e),i(e),n(e),r(e)}))});o.a.render(Object(s.jsx)(n.a.StrictMode,{children:Object(s.jsx)(ye,{})}),document.getElementById("root")),Ae()}},[[440,1,2]]]);
//# sourceMappingURL=main.b28e177b.chunk.js.map